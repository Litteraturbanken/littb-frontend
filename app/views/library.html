<meta-desc>Blädda bland Litteraturbankens författare och titlar.</meta-desc>
<h1 class="text-4xl ">Botanisera i biblioteket</h1> <!-- samlingarna -->
<!--  <span class="star">*</span> <span class="smaller">ENKEL SÖKNING</span> -->
<img bkg-img src="../img/library.jpg"></img>
<div ng-class="{searching:searching, dl_mode : dl_mode}">
    <div id="controls">
        <form class="sm:p-5 p-2 sm:border border-gray-900" ng-submit="refreshData()">
            
            <div class="">
                <div class="main_input row no-gutters">
                    <input class="filter_input col-9" autofocus 
                        ng-model-options='{debounce : {default : 300, blur : 0}, updateOn: "default blur"}' 
                        type="text" 
                        ng-change="refreshData()" ng-model="filter" 
                        placeholder="Skriv författarnamn eller titel">
                    <button class="submit btn col-auto">Sök</button>
                    <button class="submit btn col-auto" ng-show="!showInitial" ng-click="resetView()">
                        Återställ
                    </button>
                </div>
                <div class="title_select_container">
                    <select  class="gender_select" 
                             ui-select2="genderSelectSetup" 
                             ng-change="refreshData()" ng-model="filters['main_author.gender']" 
                             >
                        <option value="">Alla författare</option>
                        <option value="female">Kvinnliga författare</option>    
                        <option value="male">Manliga författare</option>
                    </select>
                </div>
                <div class="title_select_container">
                    <select multiple class="filter_select keyword_select" ui-select2 ui-select2="{placeholder: 'Välj samling'}" ng-change="refreshData()" ng-model="filters.keywords" data-placeholder="Välj samling" >
                        <option value=""></option>
                        <option value="texttype:brev">Brev</option>
                        <option value="texttype:drama">Dramatik</option>
                        <option value="texttype:novellsamling;novell">Noveller</option>
                        <option value="texttype:diktsamling;dikt">Poesi</option>
                        <option value="texttype:roman">Romaner</option>
                        <option value='keyword:Barnlitteratur'>Barn- och ungdomslitteratur</option>
                        <option value='keyword:Finlandssvenskt'>Finlandssvensk litteratur</option>
                        <option value='keyword:Humor'>Humor</option>
                        <option value='keyword:Folktryck'>Skillingtryck och folktryck</option>
                        <option value="texttype:reseskildring">Reseskildringar</option>
                        <option value='keyword:Rösträtt'>Rösträtt</option>
                        <option value='keyword:Dramawebben'>Dramawebben</option>
                        <option value='keyword:SLS-FI'>SLS Finland</option>
                        <option value='provenance.library:SVELITT'>SLS Sverige</option>
                        <option value='provenance.library:SFS'>Svenska fornskriftsällskapet</option>
                        <option value='provenance.library:SVS'>Svenska vitterhetssamfundet</option>
                        <option value='provenance.library:SVA'>Svenskt visarkiv</option>
                        <option value='keyword:sentpajorden'>Gunnar Ekelöf. Sent på jorden</option>
                        <option value='keyword:OrdenPrövas'>Harry Martinson. Orden prövas</option>
                    </select>
                </div>
                <div class="title_select_container about_container">
                    <select multiple class="filter_select about_select"
                            ui-select2 
                            ng-change="refreshData()" ng-model="filters.authorkeyword" 
                            data-placeholder="Om ett författarskap" 
                            ng-change="onAboutAuthorChange($event)">

                        <option value=""></option>
                        <option value='{{authorid}}' ng-repeat="authorid in aboutAuthors">{{authorsById[authorid].full_name}}</option>
                    </select>
                </div>

                <!-- <div class="row auth_select_container">
                    <select class="filter_select author_select" ui-select2="sortSelectSetup" ng-model="sort" data-placeholder="Sortering" ng-change="" >
                        <option value=""></option>
                        <option value="popularity|desc">Popularitet</option>
                        <option value="sortkey|asc">Titel</option>
                    </select> 
                </div> -->
                
                <div class="more mt-2" ng-class="{show_more : show_more}"><a ng-click="show_more = !show_more" ><i class="align-middle fa fa-plus-square-o mr-1"></i> Visa fler inställningar </a></div>
                <div class="more_container" ng-class="{show_more : show_more}" ng-show="show_more">
                    <div class="title_select_container">
                        <select multiple class="filter_select keyword_select" ui-select2 ng-change="refreshData()" ng-model="filters.mediatypes" data-placeholder="Utgivningsformat" >
                            <option value=""></option>
                            <option value="mediatype:etext" title="Etext är korrektuläst text som du kan läsa den direkt på skärmen; den är sökbar." >Etext</option>
                            <option value="mediatype:faksimil" title="Faksimil är fotografier av bokens sidor; den är ibland sökbar.">Faksimil</option>
                            <option value="has_epub:true" title="Epub kan du med fördel ladda ner till din mobila läsare; den är sökbar.">Epub</option>
                            <option value="mediatype:pdf" title="PDF är en fil som du kan ladda ner; den är sökbar.">PDF</option>
                        </select>
                    </div>
                    <div class="title_select_container">
                        <select multiple class="filter_select keyword_select" ui-select2 ng-change="refreshData()" ng-model="filters.languages" data-placeholder="Språk …">
                            <option value=""></option>
                            <option value="modernized:true">Moderniserat språk</option>
                            <option value="modernized:false">Ej moderniserat språk</option>
                            <option value="proofread:true">Korrekturläst</option>
                            <option value="proofread:false">Ej korrekturläst</option>
                            <option value="language:swe">Svenska</option>
                            <option value="language:eng">Engelska</option>
                            <option value="language:deu">Tyska</option>
                            <option value="language:fra">Franska</option>
                            <option value="language:lat">Latin</option>
                            <!-- <option value="">Skrivet av kvinnor</option>
                            <option value="">Skrivet av män</option> -->


                        </select>
                    </div>
                </div>
                <div class="more" ng-class="{show_more : dl_mode}">
                    <a ng-click="setDownloadMode()">
                        <!-- <i class="fa fa-caret-right"></i>  -->
                        <i class="fa fa-download color-black mr-1 text-xs"></i>
                        <span ng-if="!dl_mode"> Ladda ner källmaterial</span>
                        <span ng-if="dl_mode">Stäng källmaterial</span>
            </a></div>
                <div class="more_container h-8 relative mb-4" ng-class="{show_more : dl_mode}" ng-show="dl_mode">
                    <a class="sc btn btn-small absolute left" ng-show="!isAllVisibleSelected()" ng-click="onSelectVisible()">Välj alla verk i listan</a>
                    <a class="sc btn btn-small absolute left" ng-show="isAllVisibleSelected()" ng-click="onDeselectVisible()">Avmarkera alla verk i listan</a>
                </div>
                <!-- <a class="btn text-xs submit pull-right" ng-click="setDownloadMode()">Ladda ner…</a> -->
            </div>


            <div class="chronology primarycolor">
                <i class="fa fa-clock-o mr-1" aria-hidden="true"></i>
                <span class="sc mt-8">Kronologisk filtrering efter tryckår</span> 
                <!-- <span>{{filters['sort_date_imprint.date:range'][0]}}</span>–<span>{{filters['sort_date_imprint.date:range'][1]}}</span> -->
            </div>

            <div class="flex">
                <rzslider class="mt-4" step="1" 
                        rz-slider-model="filters['sort_date_imprint.date:range'][0]" 
                        rz-slider-high="filters['sort_date_imprint.date:range'][1]" 
                        rz-slider-options="sliderConf" >
                </rzslider>

                <div class="whitespace-no-wrap self-center chronology_inputs">
                    <input type="text" class="text-sm text-center py-1" ng-model="filters['sort_date_imprint.date:range'][0]"> <span class="text-sm  sc">till </span> <input type="text" class="text-sm text-center py-1" ng-model="filters['sort_date_imprint.date:range'][1]">
                </div>
            </div>

        </form>
        
        <!-- <div class="row box_container"> -->
        <div class="inline-flex items-stretch w-full">
            <div class="box sm:p-6 p-2 max-w-4xl sm:border border-gray-900" >

                <div class="btn-group p-0 mb-10 ">
                    <label class="sc btn btn-small" ng-class="{disabled: dl_mode || !authorData.length}" 
                        ng-model="listType" uib-btn-radio="'authors'" ng-click="setAuthorData()">
                        <span ng-if="!dl_mode">Författare</span><span ng-if="dl_mode">Författare</span><span class="num_hits">: {{authorData.length}}</span>
                    </label>
                    <label class="sc btn btn-small" 
                        ng-model="listType" uib-btn-radio="'works'" ng-click="fetchWorks()">
                        Verk<span class="num_hits" ng-show="titleModel.works_hits">: {{titleModel.works_hits}}</span>
                    </label>
                    <label ng-show="!dl_mode" class="sc btn btn-small" ng-class="{disabled: !parts_hits}" 
                        ng-model="listType" uib-btn-radio="'parts'" ng-click="fetchParts()">Dikt, novell, etc.<span class="parts num_hits" ng-show="parts_hits">: {{ parts_hits }}</span></label>
                    <label ng-show="!dl_mode" class="sc btn btn-small" ng-class="{disabled: !titleModel.epub_hits}" 
                        ng-model="listType" uib-btn-radio="'epub'" ng-click="fetchWorks(false, true)">Epub<span class="num_hits" ng-show="titleModel.epub_hits">: {{titleModel.epub_hits}}</span></label>
                    <!-- <label ng-show="!dl_mode" class="sc btn btn-small" ng-class="{disabled: !audio_list.length}" 
                        ng-model="listType" btn-radio="'audio'" ng-click="listType = 'audio'">Ljud<span class="num_hits" ng-show="audio_list.length">: {{audio_list.length}}</span></label> -->
                </div>
                
                
                <ng-include src="worksListURL" ng-if="listType == 'works'"></ng-include>

                    
                <div class="result author pl-0 sm:ml-3" ng-if="listType == 'authors'">
                    <sort-list ></sort-list>
                    <div class=""> 
                        <ul class="">
                            <li class="spinner_row" ng-show="authorSearching">
                                <i class="spinner fa fa-spinner fa-pulse"></i>
                            </li>
                            <li class="text-lg" ng-show="!authorSearching && !authorData.length">
                                Inga träffar. <span ng-show='authorSuggest[0]'>Menade du <a class="link" ng-click='setFilter(authorSuggest[0].text)'>{{authorSuggest[0].text}}</a>?</span>
                            </li>
                
                            <li ng-repeat="author in authorData | limitTo:(authLimit || Infinity) track by author.author_id"
                                class="author_row"
                                ng-click="authorClick($event, author)" 
                                on-finish-render="authorRender()" 
                                id="{{author.author_id}}">
                                <a ng-href="/forfattare/{{author.author_id}}/" class="" >
                                    <span class="surname">{{author.name_for_index.split(',')[0]}}</span><span ng-show="author.name_for_index.split(',').length > 1">,</span>
                                    {{author.name_for_index.split(",")[1]}} {{author | authorYear}}
                                </a>
                            </li>

                            <li ng-show="authLimit && authorData.length > authLimit">
                                <button class="btn btn-sm show_all"  ng-click="(authLimit = 0) || setAuthorData()">
                                    Visa alla <span class="num">{{authorData.length}}</span> träffar
                                </button>
                            </li>
                        </ul>
                    </div>
                </div>
                
                <ng-include src="worksListURL" ng-if="listType == 'epub'"></ng-include>

                <!-- <div class="result title pl-0 sm:ml-3" ng-if="listType == 'audio'">
                    <sort-list ></sort-list>
                    <table class="table w-full">
                        <tr ng-repeat="row in audio_list" class="parts" ng-class="{first_audio : $first, last_audio : $last}">
                        
                            <td uib-tooltip="{{row.title}}" class="title whitespace-no-wrap">
                                <a ng-href="/ljudarkivet?spela={{row.file}}">
                                {{row.title}}
                                </a>
                            </td>
                            
                            <td class="author text-right">
                                <span ng-if="row.readers[0].author_id != row.authors[0].author_id"><a ng-href="/forfattare/{{row.readers[0].author_id}}">{{row.readers[0].surname}}</a> <span class="lowercase">läser</span></span>
                                <a ng-href="/forfattare/{{row.authors[0].author_id}}">{{row.authors[0].surname}}</a> 
                            </td>
                        </tr>

                    </table>
                </div> -->
                <div class="result title pl-0 sm:ml-3" ng-if="listType == 'parts'">
                    <sort-list ></sort-list>
                    <div class="table-responsive-sm">
                        <table class="table">
                            <tr class="text-lg" ng-show="!partSearching && !all_titles.length">
                                <td>Inga träffar. <span ng-show='partSuggest[0]'>Menade du <a class="link" ng-click='setFilter(partSuggest[0].text)'>{{partSuggest[0].text}}</a>?</span></td>
                            </tr>
                            
                            <tr ng-repeat="row in all_titles" class="parts" ng-class="{first_part : $first}">
                            
                                <!-- <div class="header" uib-tooltip="{{::row.title != row.shorttitle ? row.title : ''}}" tooltip-popup-delay="500"> -->
                                    <td class="title" uib-tooltip="{{::row.title != row.shorttitle ? row.title : ''}}">
                                        <a ng-href="/forfattare/{{row.work_authors[0].author_id}}/titlar/{{row.work_title_id}}/sida/{{row.startpagename}}/{{row.mediatype}}">
                                        {{row.shorttitle || row.title}}
                                        </a>
                                    </td>
                                    <td class="hidden sm:table-cell">{{row.sort_date_imprint.plain}}</td>
                                    <td class="author text-right">
                                        <a ng-href="/forfattare/{{getPartAuthor(row).author_id}}">{{getPartAuthor(row).surname}}</a> 
                                        <span ng-if="getPartAuthor(row).type == 'editor'">(red.)</span>
                                        <span ng-if="getPartAuthor(row).type == 'illustrator'">(ill.)</span>
                                    </td>
                                <!-- </div> -->
                            </tr>
                            <!-- <tr ng-show="!showAllParts && parts_hits > 30 && parts_hits < 3000">
                                <td>
                                    <button class="btn btn-sm show_all"  ng-click="($parent.showAllParts = true) && fetchParts()">
                                        Visa alla <span class="num">{{parts_hits}}</span> träffar
                                    </button>
                                </td>
                            </tr> -->

                        </table>
                        <div ng-show="parts_hits > 100">
                            <ul class="pagination-sm" uib-pagination items-per-page="100" force-ellipses="true" total-items="parts_hits" max-size="10" ng-model="parts_currentpage" ng-change="request()"
                            next-text="Nästa" previous-text="Föregående"></ul>
                        </div>
                    </div>

                </div>

            </div>

            <div ng-if="dl_mode">
                <div class="dl ml-4 p-4 sticky flex flex-col overflow-auto">
                    <h3 class="uppercase text-xl mt-2 mb-2">Valda verk</h3>
                    <!-- <button class="btn text-sm" ng-click="state_add = true">Lägg till…</button> -->


                    <div class="footer">

                        
                        <button class="btn text-sm mb-4" ng-click="clearDownloads()" ng-class="{disabled : !downloads.length}">Rensa</button>

                        <button class="btn text-sm mb-4"
                            ng-click="$event.stopPropagation()"
                            ng-class="{disabled : !downloads.length}"
                            uib-popover-template="hidePopup ? undefined : downloadPopoverURL" 
                            uib-popover-title="Välj format"
                            uib-popover-placement="left">
                            Välj format
                            <i class="fa fa-download ml-2"></i>
                        </button>

                
                    <ul class="mt-2 mb-2 flex-grow">
                        <li class="download_item hover:line-through" ng-repeat="row in downloads"
                        ng-click="toggleDownload(row, true)">
                            <span class="sc">{{row.main_author.surname}}</span> {{row.shorttitle || row.title}}
                        </li>
                    </ul>

                    </div>
                </div>
            </div>
        </div>
    </div>

</div>

