<meta-desc>{{authorInfo.full_name}}, {{getPageTitle(showpage)}}</meta-desc>
<page-title>{{authorInfo.full_name}}, {{getPageTitle(showpage)}}</page-title>
<img ng-if="!slaMode" bkg-img class="no-gradient" src="img/forf2_bkg.jpg"></img>
<img ng-if="slaMode && showpage == 'jamfor'" bkg-img class="no-gradient" src="img/sla_bkg_gradient.jpg"></img>

<img ng-if="slaMode && showpage != 'jamfor'" bkg-img class="no-gradient" src="img/sla_bkg.jpg"></img>

<div ng-class="{searching:!authorInfo, show_large : show_large}">
    <div class="preloader"> 
        <i class="spinner fa fa-spinner fa-pulse"></i>
    </div>
    <div class="error" ng-if="authorError" >Ett fel har inträffat: författarid <code>{{author}}</code> kan inte hittas. Kontrollera adressen.</div>
    <h1>{{authorInfo.full_name}} <span class="author_year" ng-if="authorInfo | authorYear"> ({{authorInfo | authorYear}})</span></h1>
    <!-- <div ng-if="show_large" class="img_large"><img ng-src="{{authorInfo.largeImage}}"></div> -->
    <ul class="links" ng-show="authorInfo"> 
        <li ng-class="{active : showpage == 'introduktion'}" ng-if="authorInfo.intro"><a href="/#!/forfattare/{{author}}">Introduktion</a></li>
        <li ng-class="{active : showpage == 'titlar'}"><a href="/#!/forfattare/{{author}}/titlar">Verk</a></li>
        <li ng-show="authorInfo.presentation" ng-class="{active : showpage == 'presentation'}"><a href="/#!/forfattare/{{author}}/presentation">Presentation</a></li>
        <li ng-show="authorInfo.bibliography" ng-class="{active : showpage == 'bibliografi'}"><a href="/#!/forfattare/{{author}}/bibliografi">Bibliografi</a></li>
        <li ng-class="{active : showpage == 'mer'}" ng-if="authorInfo.show_more"><a ng-href="/#!/forfattare/{{author}}/las-mer">Läs mer</a></li>
        <li ng-class="{active : showpage == 'mer'}" ng-if="hasMore()"><a ng-href="/#!/forfattare/{{author}}/mer">Mer</a></li>
        <li ng-if="authorInfo.searchable"><a href="/#!/sok?forfattare={{author}}&avancerad">Sök i texterna</a></li>
    </ul>
    
    <div class="page_content" ng-switch="showpage">
        <div ng-switch-when="introduktion">
            <div class="sla_intro" ng-if="slaMode" ng-bind-html="slaIntro | trust"></div>
            <div class="introtext" ng-class="{show_more: show_more}">
                <div ng-bind-html="authorInfo.intro | trust"></div>
                <div class="pull-right"><em>{{authorsById[normalizeAuthor(authorInfo.intro_author)].full_name}}</em></div>

                <div class="source" ng-if="authorInfo.sources">
                    <span class="source_header sc">Källa</span>
                    <span class="source_text" ng-bind-html='authorInfo.sources.join("<br>") | trust'></span>
                </div>
            </div>


            <div class="portrait_container">
                <img ng-show="authorInfo.smallImage" class="author_img" ng-src="{{authorInfo.largeImage}}" > <!-- ng-click="showLargeImage($event)" -->
                <figcaption>{{authorInfo.pictureinfo}}</figcaption>
                <!-- <ul class="links">
                    <li><a href="/#!/forfattare/{{author}}/titlar">Tillgängliga titlar</a></li>
                    <li><a href="/#!/sok?forfattare=BenedictssonV">Sök i texterna</a></li>
                    <li><a ng-href="/#!/forfattare/{{author}}/semer">Mer om författaren</a></li>
                </ul> -->
            </div>
            

            <div class="show_more_btn" ng-show="!show_more"> <i class="fa fa-caret-down"></i> <a href="" ng-click="show_more = true"> LÄS MER</a></div>
            
        </div>

        <script type="text/ng-template" id="listing.html">
            <div ng-class="{content : slaMode}" ng-repeat="titleobj in getDataSource()" ng-show="authorInfo && titleobj.data.length">
                <h2 ng-show="!slaMode" ng-show="titleobj.data.length">{{titleobj.label}}</h2>
                <h1 ng-show="slaMode" ng-show="titleobj.data.length">{{titleobj.label}}</h1>

                <table class="contenttable" ng-class="{extra_wide : titleobj.showAuthor}">
                    <tr ng-repeat="work in titleobj.data | orderBy:['authors[0].surname', 'sortkey'] track by $index">
                        <td class="mediatypes">
                            <a ng-if="work.doc_type == 'audio'" ng-href="/#!/ljudarkivet?spela={{work.file}}">Lyssna</a>
                            <span ng-repeat="mediatype in work.mediatypes track by $index ">
                                <!-- <span ng-show="!$first">::: </span> -->
                                <a ng-href="{{mediatype.url}}">{{mediatype.label}}</a>
                                <span ng-show="!last">&nbsp; </span>
                            </span>
                        </td>
                        <td ng-if="titleobj.showAuthor">
                            <a href="/#!/forfattare/{{titleobj.showAuthor(work)[0].author_id}}">{{titleobj.showAuthor(work)[0].name_for_index}}</a>
                        </td>
                        <td>
                            <a class="title" 
                                ng-href="{{work.mediatypes[0].url + '?om-boken'}}">
                                {{work.shorttitle || work.showtitle}}
                            </a>
                                
                            <div class="extras" ng-if="$parent.$index != 0 && work.workshorttitle">i
                                <a class="author" href="/#!/forfattare/{{work.work_authors[0].author_id}}">
                                    {{work.work_authors[0].surname}}:
                                </a> 
                                <span class="extras_title">{{work.workshorttitle}}</span>
                            </div>
                            
                            <span class="dots"></span>
                        </td>
                        
                    </tr>
                </table>
            </div>
            
        </script>

        <div ng-switch-when="titlar">
            <ng-include src="'listing.html'"></ng-include>
        </div>
        <div ng-switch-when="mer">
            <!-- <div class="content" footnote-popup="noteMapping" ng-bind-html="externalDoc | trust"></div> -->
           <ng-include src="'listing.html'"></ng-include>
        </div>
    
        <div ng-switch-when="biblinfo"><div ng-include="'views/sla/biblinfo.html'"></div></div>
    
        <div ng-switch-when="jamfor"><div ng-include="'views/sla/textjamforelse.html'"></div></div>
    
        <!-- <div ng-switch-default id="author-info-external"></div> -->
        <div ng-switch-default>
           <div class="content" footnote-popup="noteMapping" ng-bind-html="externalDoc | trust"></div>
       </div>
    </div>

    
</div>


<div toolkit>
    <div ng-show="slaMode">
        <a href="/#!/forfattare/LagerlofS" class="sla_logo"></a>
        <ul class="subnav" role="navigation">
            <li>
                <a ng-href="/#!/forfattare/{{author}}/titlar" >Verk i LB</a>
            </li>
            <li><a ng-href="/#!/forfattare/{{author}}" >Introduktion</a></li>
            <li><a ng-href="/#!/forfattare/{{author}}/presentation">Presentation</a></li>
            <li><a ng-href="/#!/forfattare/{{author}}/bibliografi">Bibliografi</a></li>
            <li ng-repeat="ref in authorInfo.externalref">
                <a ng-href="/#!/{{ref.url}}">{{ref.label}}</a>
            </li>
            <ul ng-if="slaMode">
                <li><a ng-href="/#!/forfattare/{{author}}/jamfor">Textkritik</a></li>
                <li><a ng-href="/#!/forfattare/{{author}}/omtexterna">Vetenskap</a></li>
            </ul>
        </ul>
    </div>
</div>
