angular.module("dibari.angular-ellipsis",[]).directive("ellipsis",["$timeout","$window",function(a,b){return{restrict:"A",scope:{ngBind:"=",ellipsisAppend:"@",ellipsisAppendClick:"&",ellipsisSymbol:"@",ellipsisSeparator:"@"},compile:function(c,d,e){return function(c,d,e){function f(){if(c.ngBind){var a=0,b="undefined"!=typeof e.ellipsisSymbol?e.ellipsisSymbol:"&hellip;",f="undefined"!=typeof c.ellipsisSeparator?e.ellipsisSeparator:" ",h="undefined"!=typeof c.ellipsisAppend&&""!==c.ellipsisAppend?b+"<span>"+c.ellipsisAppend+"</span>":b,i=c.ngBind.split(f);if(e.isTruncated=!1,d.text(c.ngBind),g(d)){var j=i.length,k=d[0].clientHeight;for(d.text(c.ngBind).html(d.html()+h),d.attr("data-overflowed","true");j>a;a++)if(i.pop(),d.text(i.join(f)).html(d.html()+h),d[0].scrollHeight<k||g(d)===!1){e.isTruncated=!0;break}b!=h&&"undefined"!=typeof c.ellipsisAppendClick&&""!==c.ellipsisAppendClick&&d.find("span").bind("click",function(a){c.$apply(function(){c.ellipsisAppendClick.call(c,{event:a})})})}}}function g(a){return a[0].scrollHeight>a[0].clientHeight}function h(){a.cancel(e.lastWindowTimeoutEvent),e.lastWindowTimeoutEvent=a(function(){(e.lastWindowResizeWidth!=window.innerWidth||e.lastWindowResizeHeight!=window.innerHeight)&&f(),e.lastWindowResizeWidth=window.innerWidth,e.lastWindowResizeHeight=window.innerHeight},75)}e.lastWindowResizeTime=0,e.lastWindowResizeWidth=0,e.lastWindowResizeHeight=0,e.lastWindowTimeoutEvent=null,e.isTruncated=!1,c.$watch("ngBind",function(){a(function(){f()})}),c.$watch("ellipsisAppend",function(){f()});var i=angular.element(b);i.bind("resize",h),c.$on("$destroy",function(){i.unbind("resize",h)})}}}}]);